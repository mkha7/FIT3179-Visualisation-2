{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "width": 800,
  "height": 450,
  "title": {
    "text": "Property Transactions in Malaysia - Interactive Filtering",
    "anchor": "middle",
    "fontSize": 16,
    "fontWeight": "bold"
  },
  "background": "#D0E8F2",
  "projection": {
    "type": "mercator",
    "scale": 2400,
    "center": [108, 3],
    "translate": [400, 225]
  },
  "layer": [
    {
      "data": {
        "url": "https://raw.githubusercontent.com/mkha7/vega-lite-real-estate-visualization/refs/heads/main/ne_110m%20(2).json",
        "format": {"type": "topojson", "feature": "ne_110m_admin_0_countries"}
      },
      "mark": {"type": "geoshape", "fill": "lightgray", "stroke": "white"}
    },
    {
      "data": {
        "values": [
          {
            "State": "Selangor",
            "longitude": 101.5183,
            "latitude": 3.0738,
            "Transactions": 55035,
            "Value": 30.26
          },
          {
            "State": "Johor",
            "longitude": 103.7414,
            "latitude": 1.4927,
            "Transactions": 40561,
            "Value": 18.12
          },
          {
            "State": "Kuala Lumpur",
            "longitude": 101.6869,
            "latitude": 3.139,
            "Transactions": 5927,
            "Value": 3.63
          },
          {
            "State": "Penang",
            "longitude": 100.3327,
            "latitude": 5.4164,
            "Transactions": 8000,
            "Value": 4.02
          },
          {
            "State": "Perak",
            "longitude": 101.0981,
            "latitude": 4.5921,
            "Transactions": 15823,
            "Value": 6.45
          },
          {
            "State": "Pahang",
            "longitude": 103.4167,
            "latitude": 3.75,
            "Transactions": 10645,
            "Value": 5.31
          },
          {
            "State": "Terengganu",
            "longitude": 103.1412,
            "latitude": 5.3117,
            "Transactions": 6093,
            "Value": 3.03
          },
          {
            "State": "Kelantan",
            "longitude": 102.2381,
            "latitude": 6.1256,
            "Transactions": 7320,
            "Value": 4.12
          },
          {
            "State": "Negeri Sembilan",
            "longitude": 102.2462,
            "latitude": 2.7254,
            "Transactions": 8097,
            "Value": 4.75
          },
          {
            "State": "Melaka",
            "longitude": 102.2501,
            "latitude": 2.1896,
            "Transactions": 5642,
            "Value": 2.96
          },
          {
            "State": "Sabah",
            "longitude": 116.0753,
            "latitude": 5.9788,
            "Transactions": 18275,
            "Value": 9.8
          },
          {
            "State": "Sarawak",
            "longitude": 113.0351,
            "latitude": 2.7764,
            "Transactions": 14202,
            "Value": 7.33
          },
          {
            "State": "Labuan",
            "longitude": 115.235,
            "latitude": 5.2831,
            "Transactions": 1500,
            "Value": 0.75
          },
          {
            "State": "Perlis",
            "longitude": 100.2272,
            "latitude": 6.4405,
            "Transactions": 2000,
            "Value": 1.02
          }
        ]
      },
      "transform": [
        {"filter": "datum.State == State_selection || State_selection == null"}
      ],
      "mark": {
        "type": "circle",
        "tooltip": {"content": "data"},
        "stroke": "black",
        "strokeWidth": 0.8
      },
      "encoding": {
        "longitude": {"field": "longitude", "type": "quantitative"},
        "latitude": {"field": "latitude", "type": "quantitative"},
        "size": {
          "field": "Transactions",
          "type": "quantitative",
          "title": "Number of Transactions",
          "scale": {"domain": [5000, 60000], "range": [100, 1000]}
        },
        "color": {
          "field": "Value",
          "type": "quantitative",
          "title": "Value of Transactions in Billion",
          "scale": {"scheme": "blues"}
        },
        "tooltip": [
          {"field": "State", "type": "nominal", "title": "State"},
          {
            "field": "Transactions",
            "type": "quantitative",
            "title": "Number of Transactions"
          },
          {
            "field": "Value",
            "type": "quantitative",
            "title": "Transaction Value (Billion RM)"
          }
        ]
      }
    },
    {
      "data": {
        "values": [
          {"longitude": 101.5, "latitude": 0.2, "label": "West Malaysia"},
          {"longitude": 115, "latitude": 0.2, "label": "East Malaysia"}
        ]
      },
      "mark": {
        "type": "text",
        "fontSize": 14,
        "fontWeight": "bold",
        "color": "black",
        "align": "center"
      },
      "encoding": {
        "longitude": {"field": "longitude", "type": "quantitative"},
        "latitude": {"field": "latitude", "type": "quantitative"},
        "text": {"field": "label", "type": "nominal"}
      }
    },
    {
      "data": {
        "values": [
          {
            "longitude": 101.5,
            "latitude": -0.1,
            "note": "High transactions in this region"
          },
          {
            "longitude": 115,
            "latitude": -0.1,
            "note": "Lower transactions in this region"
          }
        ]
      },
      "mark": {
        "type": "text",
        "fontSize": 12,
        "fontWeight": "normal",
        "color": "black",
        "align": "center"
      },
      "encoding": {
        "longitude": {"field": "longitude", "type": "quantitative"},
        "latitude": {"field": "latitude", "type": "quantitative"},
        "text": {"field": "note", "type": "nominal"}
      }
    }
  ],
  "params": [
    {
      "name": "State_selection",
      "bind": {
        "input": "select",
        "options": [
          null,
          "Selangor",
          "Johor",
          "Kuala Lumpur",
          "Penang",
          "Perak",
          "Pahang",
          "Terengganu",
          "Kelantan",
          "Negeri Sembilan",
          "Melaka",
          "Sabah",
          "Sarawak",
          "Labuan",
          "Perlis"
        ],
        "labels": [
          "Show All",
          "Selangor",
          "Johor",
          "Kuala Lumpur",
          "Penang",
          "Perak",
          "Pahang",
          "Terengganu",
          "Kelantan",
          "Negeri Sembilan",
          "Melaka",
          "Sabah",
          "Sarawak",
          "Labuan",
          "Perlis"
        ],
        "name": "Filter by State: "
      }
    }
  ],
  "config": {}
}